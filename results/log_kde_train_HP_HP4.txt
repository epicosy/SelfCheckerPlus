Namespace(dataset='HP', model='HP4', flag='train', batch_size=128, save_path='./tmp/HP/HP4/', var_threshold=1e-05, num_classes=2, regularized_kde=True)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 12)                132       
                                                                 
 dense_1 (Dense)             (None, 10)                130       
                                                                 
 dense_2 (Dense)             (None, 10)                110       
                                                                 
 dense_3 (Dense)             (None, 1)                 11        
                                                                 
=================================================================
Total params: 383 (1.50 KB)
Trainable params: 383 (1.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Train: (1168, 10) (1168,)
Val: (146, 10) (146,)
Test: (146, 10) (146,)
[94m### y_train len:1168 ###[0m
[92m### y_valid len:146 ###[0m
[94m[train] [0mModel serving
 1/10 [==>...........................] - ETA: 0s10/10 [==============================] - 0s 941us/step
[94m[train] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
[92mtrain ATs is saved at ./tmp/HP/HP4/train_dense_dense_1_dense_2_dense_3_ats.npy[0m
[94m[valid] [0mModel serving
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
[94m[valid] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
[92mvalid ATs is saved at ./tmp/HP/HP4/valid_dense_dense_1_dense_2_dense_3_ats.npy[0m
[94mLayer: dense[0m
layer_index: 0, var_threshold: 1e-05
[94mcalc kdes...[0m
refined ats shape: (9, 579)
refined ats min max 0.0 ; 2.187779188156128 
min_kde: 24.280587324170334
max_kde: 3979.7936026508128
refined ats shape: (9, 589)
refined ats min max 0.0 ; 2.123547315597534 
min_kde: 36.7654464355133
max_kde: 6832.843423654586
gaussian_kde(refined_ats) shape[1] sum: 1168
[92mThe number of removed columns: 3[0m
[94m[dense] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.8835616438356164
[94mTP: 68  FN: 4  FP: 13  TN: 61[0m
[92mTPR: 0.9444444444444444  FPR: 0.17567567567567569  F-1: 0.8888888888888888[0m
[94mLayer: dense_1[0m
remove existing kde functions!
layer_index: 1, var_threshold: 0
[94mcalc kdes...[0m
refined ats shape: (10, 579)
refined ats min max 0.0 ; 2.6957736015319824 
min_kde: 81.41960683283614
max_kde: 16885.128111858307
refined ats shape: (10, 589)
refined ats min max 0.0 ; 2.3080735206604004 
min_kde: 135.97186747798077
max_kde: 20072.129598955285
gaussian_kde(refined_ats) shape[1] sum: 1168
[92mThe number of removed columns: 0[0m
[94m[dense_1] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.8972602739726028
[94mTP: 68  FN: 4  FP: 11  TN: 63[0m
[92mTPR: 0.9444444444444444  FPR: 0.14864864864864866  F-1: 0.9006622516556292[0m
[94mLayer: dense_2[0m
layer_index: 2, var_threshold: 0
[92mThe number of removed columns: 0[0m
[94mload kdes from file:./tmp/HP/HP4//kdes-pack/dense_2[0m
[94m[dense_2] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.8972602739726028
[94mTP: 68  FN: 4  FP: 11  TN: 63[0m
[92mTPR: 0.9444444444444444  FPR: 0.14864864864864866  F-1: 0.9006622516556292[0m
[94mLayer: dense_3[0m
layer_index: 3, var_threshold: 0
[92mThe number of removed columns: 0[0m
[94mload kdes from file:./tmp/HP/HP4//kdes-pack/dense_3[0m
[94m[dense_3] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.8835616438356164
[94mTP: 67  FN: 5  FP: 12  TN: 62[0m
[92mTPR: 0.9305555555555556  FPR: 0.16216216216216217  F-1: 0.8874172185430463[0m
