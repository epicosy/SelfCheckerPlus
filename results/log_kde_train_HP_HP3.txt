Namespace(dataset='HP', model='HP3', flag='train', batch_size=128, save_path='./tmp/HP/HP3/', var_threshold=1e-05, num_classes=2, regularized_kde=True)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 12)                132       
                                                                 
 dense_1 (Dense)             (None, 10)                130       
                                                                 
 dense_2 (Dense)             (None, 1)                 11        
                                                                 
=================================================================
Total params: 273 (1.07 KB)
Trainable params: 273 (1.07 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Train: (1168, 10) (1168,)
Val: (146, 10) (146,)
Test: (146, 10) (146,)
[94m### y_train len:1168 ###[0m
[92m### y_valid len:146 ###[0m
[94m[train] [0mModel serving
 1/10 [==>...........................] - ETA: 0s10/10 [==============================] - 0s 818us/step
[94m[train] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
[92mtrain ATs is saved at ./tmp/HP/HP3/train_dense_dense_1_dense_2_ats.npy[0m
[94m[valid] [0mModel serving
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 1ms/step
[94m[valid] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
[92mvalid ATs is saved at ./tmp/HP/HP3/valid_dense_dense_1_dense_2_ats.npy[0m
[94mLayer: dense[0m
layer_index: 0, var_threshold: 1e-05
[94mcalc kdes...[0m
refined ats shape: (11, 579)
refined ats min max 0.0 ; 1.2873458862304688 
min_kde: 507.0610574419188
max_kde: 92231.9366439915
refined ats shape: (11, 589)
refined ats min max 0.0 ; 1.0643525123596191 
min_kde: 397.9878458553875
max_kde: 62049.4970806541
gaussian_kde(refined_ats) shape[1] sum: 1168
[92mThe number of removed columns: 1[0m
[94m[dense] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.863013698630137
[94mTP: 67  FN: 5  FP: 15  TN: 59[0m
[92mTPR: 0.9305555555555556  FPR: 0.20270270270270271  F-1: 0.8701298701298701[0m
[94mLayer: dense_1[0m
remove existing kde functions!
layer_index: 1, var_threshold: 0
[94mcalc kdes...[0m
refined ats shape: (10, 579)
refined ats min max 0.0 ; 0.8272318243980408 
min_kde: 368.7467227291682
max_kde: 104566.15329173632
refined ats shape: (10, 589)
refined ats min max 0.0 ; 0.7065773010253906 
min_kde: 487.45811193939534
max_kde: 56695.57107869175
gaussian_kde(refined_ats) shape[1] sum: 1168
[92mThe number of removed columns: 0[0m
[94m[dense_1] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.8424657534246576
[94mTP: 62  FN: 10  FP: 13  TN: 61[0m
[92mTPR: 0.8611111111111112  FPR: 0.17567567567567569  F-1: 0.8435374149659864[0m
[94mLayer: dense_2[0m
layer_index: 2, var_threshold: 0
[92mThe number of removed columns: 0[0m
[94mload kdes from file:./tmp/HP/HP3//kdes-pack/dense_2[0m
[94m[dense_2] [0mFetching KDE inference
model accuracy: valid, 0.5068493150684932
kde accuracy:valid, 0.4931506849315068
[94mTP: 72  FN: 0  FP: 74  TN: 0[0m
[92mTPR: 1.0  FPR: 1.0  F-1: 0.6605504587155964[0m
